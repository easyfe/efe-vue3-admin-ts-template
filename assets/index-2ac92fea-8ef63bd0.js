import"./index-aee48219.js";import{e}from"./index-16604dbe-a62203c4.js";import{M as a,a_ as u}from"./ui-4b961b37.js";import{e as r,c as l,h as t,q as s,C as i,v as o,x as n}from"./core-e904f21d.js";const d=r({name:"Upload",__name:"index",props:{modelValue:{default:()=>""},maxSize:{default:0}},emits:["update:modelValue"],setup(r,{emit:d}){const m=r,p=l({get:()=>m.modelValue,set:e=>{d("update:modelValue",e)}}),f=l((()=>Array.isArray(p.value)?p.value.map((e=>({uid:e,name:e,status:"done",url:e}))):[{uid:p.value,name:p.value,status:"done",url:p.value}]));function c(e){return new Promise(((u,r)=>{if(m.maxSize&&e.size>1024*m.maxSize){const e=function(e){return e<1024?e+" B":e<1048576?(e/1024).toFixed(2)+" KB":e<1073741824?(e/1048576).toFixed(2)+" MB":(e/1073741824).toFixed(2)+" GB"}(1024*m.maxSize);a.error(`文件大小不能超过${e}`),r(!1)}u(!0)}))}function v(e){return new Promise((a=>{const u=f.value.findIndex((a=>a.url===e.url));u>-1&&(f.value.splice(u,1),p.value=f.value.map((e=>e.url))),a(!0)}))}function x(e){e.url&&(Array.isArray(p.value)?p.value.push(e.url):p.value=e.url)}return(a,r)=>{const l=u;return t(),s(e,null,{default:i((()=>[o(l,n({"list-type":"picture-card","image-preview":!0,"default-file-list":f.value,accept:"image/*","on-before-upload":c,"on-before-remove":v},a.$attrs,{onSuccess:x}),null,16,["default-file-list"])])),_:1})}}});export{d as default};
